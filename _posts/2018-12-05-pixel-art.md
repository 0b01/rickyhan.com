---
layout: post
title:  "Pixel Art Algorithm: Removing Jaggies by Sorting Monotonic Curve by Segment Slope"
date:   2018-11-22 00:37:02 -0400
# menu: main
categories: jekyll update
---

Xprite is a new program I am developing on and off(mostly off). It is an innovative pixel art editor with a bunch of cool algorithms. Most functionalities are unimplemented but the algorithms are done.

# Removing jaggies

Jaggies are the out of place pixels in a curve.

![curve](/static/pixelart/black.svg)

Currently, in order to draw a perfect curve, a pixel artist has to put in the herculean effort of planning the slope of each segments and painstakingly brush them in one by one.

![slope](/static/pixelart/slope.svg)

My algorithm basically sorts the curve segments by slope during the rasterization step. Note this only applies to monotonically increasing/decreasing curves. So a more complex curve shape(sine wave) is destructured into a bunch of monotonic cubic beziers that share adjacent control points.

<div style="background: azure;">
<style>
    #canvas {
        cursor: none;
        height: 600px;
        width: 600px;
        border: 1px solid blue;
    }
</style>
<canvas id="canvas" width="600" height="600"> </canvas>
<script>
    setTimeout( function() {
        xprite.change_tool("pencil");
        xprite.set_option_for_tool("pencil", "simplify", "false");
    }, 100);
</script>
<script src="/static/pixelart/xprite.js"></script>
</div>


I originally used WebAssembly + HTML canvas for frontend which is a terrible choice since the browser just can't up with the mouse movements. Recently, I ditched the web part and rewrote the UI in Dear ImGui and it's about 1000x faster. However, I separated out the renderer into its own trait so hopefully web support is still a possibility once the native app is done.
